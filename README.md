# NetworkProject

네트워크 프로젝트에 사용할 깃 리포지토리

## 프로젝트 개요
포트리스를 모티브로 만든 프로젝트입니다.

## 실행 가이드
### 로그인
먼저 계정 생성을 진행합니다.
회원가입의 경우 이메일과 비밀번호, 비밀번호 확인 3가지를 입력 받습니다.
그 후 로그인을 진행하면 로그아웃을 할 때까지 해당 계정으로 자동 로그인이 됩니다.
만약 이미 접속중인 계정으로 로그인한다면 중복로그인 방지로 로그인이 거절됩니다.

### 메인 메뉴
먼저 가입후 메인 메뉴로 넘어오셨다면 닉네임 입력 창이 뜹니다.
해당 창을 닫으셔도 설정 -> 계정 -> 닉네임 변경 을 통해 닉네임 설정이 가능하지만
닉네임이 없다면 게임 진행이 힘들어 질 수 있으므로 설정해주시기를 권장드립니다.

메인 메뉴에서는 크게 로비로 이동과 탱크 뽑기가 존재합니다.
먼저 탱크 뽑기를 보자면
게임이 종료될 때 플레이어의 성적에 따라서 재화를 받습니다.

※ 쿠폰

현재는 테스트용으로 쿠폰을 사용할 수 있습니다.
오른쪽 상단의 버튼을 누르시면 쿠폰을 사용하실 수 있고 쿠폰 번호는 WELCOME 입니다.

해당 재화를 사용하여 뽑기를 진행할 수 있는데
탱크마다 레어도가 존재하고 레어도에 따라 등장 확률이 상이합니다.
뽑기를 진행한다면 뽑힌 탱크들이 자동으로 데이터베이스에 저장됩니다.
만약 동일한 탱크를 레벨업 기준보다 많이 획득했을 경우에 자동으로 레벨업을 진행합니다.
이전에 진행한 뽑기 내용과 뽑기 확률은 왼쪽 버튼에서 확인하실 수 있습니다.

메인 메뉴로 돌아와 보유 탱크에서 뽑기로 획득한 탱크들을 확인할 수 있습니다.
만약 방금 생성한 계정이라면 기본 지급 탱크인 C급 하나가 있을겁니다.

이제 로비 이동을 진행합니다.

### 로비
로비에서는 크게 2가지 행동을 할 수 있습니다.
방을 만들거나 방에 들어가거나 입니다.

방을 만든다면 만들때 해당 방의 최대 인원과 방의 비밀번호를 설정할 수 있습니다.
비밀번호를 설정한다면 해당 방에 진입할 때 비밀번호를 요구합니다.

방에 들어간다면 이 역시 2가지 방법이 존재합니다.
빠른 입장과 패널 클릭입니다.
빠른 입장의 경우 비밀 방이 아닌 진행중이지 않은 랜덤한 방으로 진입합니다.
만약 진입 가능한 방이 없는 경우 에러 메시지를 띄웁니다.
패널 클릭의 경우는 방 리스트 패널에 생성된 방들의 패널이 뜹니다.
각 방들은 입장이 불가능한 상태면 패널이 붉은 색이고 가능한 상태면 푸른 색입니다.
그리고 패널 밑의 방패 모양이 빨간 색이면 비밀 방, 파란 색이라면 일반 방입니다.

### 룸
룸으로 들어간다면 우선 레드 팀을 우선적으로 둘 중 사람이 적은 팀으로 이동합니다.
룸에서는 많은 행동들을 할 수 있습니다.
먼저 탱크 선택입니다.
아까 탱크 뽑기에서 얻은 탱크를 기반으로 내가 이번 배틀에 사용할 탱크를 선택할 수 있습니다.

그리고 팀 변경입니다. 각 팀 패널 옆의 화살표를 누르면 해당 팀으로 이동할 수 있습니다.
만약 해당 팀이 MaxPlayer/2보다 많을 경우 해당 팀으로는 이동할 수 없습니다.
만약 팀 교환을 원한다면 대기자 패널을 이용해주시면 좋습니다.

그리고 채팅 기능입니다.
Tab키를 사용해 전체 채팅과 팀 채팅을 번갈아 사용할 수 있습니다.
전체 채팅의 경우 방에 존재하는 모든 플레이어에게 메시지를 보내고
팀 채팅의 경우 같은 팀원에게만 메시지를 보냅니다.

맵 설정과 방 설정의 경우는 방장(마스터 클라이언트)만 진행할 수 있습니다.
배틀에 사용할 맵과 설정을 방장이 직접 정할 수 있습니다.

이제 방의 모든 플레이어가 레드, 블루 팀에 존재하고 준비를 마쳤다면
방장의 시작 버튼이 활성화됩니다.
해당 버튼을 누르면 배틀 씬으로 이동합니다.

### 배틀

#### 맵

배틀의 경우 이전 룸에서 골랐던 맵의 스프라이트를 불러와서 사용합니다.
해당 맵의 스폰포인트 중 랜덤하게 플레이어들을 배치하고
방 설정에 따라서 턴을 배정합니다.

해당 맵은 만약 플레이어의 공격에 의해 투사체를 맞는다면 지형이 점차 파괴되고 
플레이어나 투사체, 아이템 등이 해당 맵의 정해진 영역 (MapBoundary)를 넘어가게 된다면 소멸합니다.
따라서 이를 전략적으로 사용하는 것이 필요할 겁니다.

오른쪽 하단 UI에는 미니맵이 존재합니다
우리 팀과, 상대 팀, 스폰된 아이템, 그리고 맵이 미니맵으로 볼 수 있습니다.

맵에는 매턴마다 달라지는 바람이 불고 있습니다.
이는 플레이어에게 영향을 주지는 않지만 탄환에 영향을 줍니다.
탄환을 쏘실 때 이에 대한 고려가 필요할 것 입니다.

#### 투사체

이제는 투사체에 대한 가이드입니다.
투사체의 경우 각자 사용하는 탱크에 따라서 다를수도 있고 같을 수도 있습니다.

플레이어의 공격에 맞춰 생성되고 동기화 작업을 진행합니다.
투사체의 방향은 현재의 운동 방향을 향합니다.

투사체가 Trigger를 통해 맵이나, 맵 영역 경계, 플레이어를 만난다면
그 위치에서 폭발을 진행합니다.
이 또한 투사체의 종류에 따라서 폭발 반경이나 모양이 다르며
해당 폭발 반경 내에 플레이어가 있다면 데미지를 줍니다.

방 설정의 팀 데미지 여부에 따라서 같은 팀이라면 데미지를 안 줄 수도 있습니다.

#### 플레이어

플레이어에 대한 가이드 입니다.
플레이어의 경우 각자의 턴이 정해져 있습니다.
해당 턴은 방에서 들어올 때 정해지며 자신의 턴이라는 알림을 받아 진행합니다.
턴이 시작되면 해당 유저의 턴이라는 사실을 팝업 이미지로 표시하고 
해당하는 플레이어는 로컬 이미지로 화살표를 머리 위에 띄웁니다.

턴이 종료되는 조건은 크게 3가지 입니다.
시간 제한 초과, 공격 진행, 턴 엔드 버튼 클릭

시간 제한의 경우 하단부 UI에서 확인하실 수 있으며 해당 시간이 0이 될 때까지
차지를 시작하지 않는다면 다음 턴으로 넘어갑니다.
차지를 시작한다면 해당 타이머는 정지합니다.

공격의 경우는 상하 방향키로 조준을 마친 뒤 
스페이스 바를 눌러 차지를 시작하여 진행합니다.
차지가 max가 되거나 스페이스 바에서 손을 뗀다면 
해당 파워로 투사체가 발사됩니다.

턴 엔드 버튼을 클릭할 경우
발사를 진행하지 않고 바로 다음 턴으로 턴을 넘깁니다.

공격을 진행할 경우 해당 투사체를 카메라가 따라갑니다.
그 후 폭발을 기다렸다가 다시 플레이어에게로 카메라가 돌아옵니다.

턴이 넘어갈 때 다시 해당 플레이어에게로 포커스가 넘어가고
해당 플레이어의 조작이 활성화됩니다.

각 플레이어는 체력바와 플레이어 이름을 가지고 있습니다.
이름은 팀에 따라 다른 색깔을 가지고 있고
체력이 줄어든다면 체력바 역시 줄어듭니다.

#### 아이템

아이템의 경우 플레이어 턴 사이클이 종료될 때 스폰됩니다.
턴 사이클은 모든 플레이어들의 턴을 한바퀴 돌린 상태로
해당 사이클이 종료됬을 때 다시 턴을 원래의 순서대로 채우고
다음 턴을 진행하기 전에 아이템 스폰을 진행합니다.

아이템의 경우 우선 랜덤 박스의 형태로 떨어집니다.
mapboundary의 경계를 받아 해당 경계의 랜덤한 x좌표와 최상단의 y좌표에서 스폰되어
x좌표를 sin 곡선을 그리며 내려옵니다.
아이템이 맵을 만나면 해당 위치에서 멈추고
플레이어를 만난다면 해당 플레이어의 item inventory에 들어갑니다. 

해당 플레이어의 하단부 ui에 아이템이 등록되고
플레이어의 턴이 왔을 때 해당 아이템을 사용할 수 있습니다.
현재 아이템은 7종류가 존재하며 모든 아이템이 동일 확률로 생성됩니다.

아이템 사용의 경우 해당 ui를 클릭했을 때 진행합니다.
ui를 클릭했을 때 해당 아이템의 사용 사실이 전달되며
효과를 발동합니다.

플레이어나 맵 경계를 아이템 랜덤 박스가 부딛힌다면 해당 object를 삭제를 진행합니다.
단, 플레이어의 현재 item이 2개 이상일 경우 더이상 획득을 진행하지 않고 무시합니다.

그리고 아이템이 스폰될 때 스폰된 아이템들의 정보를 linkedlist의 형태로 저장하고 있습니다.
만약 해당 랜덤 박스 오브젝트가 Destroy된다면 바로 Remove를 진행합니다.
만일 스폰된 랜덤 박스가 일정 숫자 (제한 숫자)를 넘긴다면 linkedlist의 first를 꺼내어
스폰된지 오래된 아이템부터 삭제를 진행합니다.

#### 게임 종료 판정

이제 게임을 진행하면서 각 팀의 남은 인원 수를 체크합니다.
만약 어느 한 팀의 남은 인원수가 0명이 되었다면 게임 종료를 실행합니다.
현재 플레이어가 정상적이지 않은 방법으로 종료를 했을 시에 사망 처리가 진행됩니다.

플레이어가 준 데미지나 킬 카운트 같은 내용을 내부 데이터로 저장하고 있습니다.
게임 종료가 실행되었을 때, 해당 데이터를 기준으로 MVP를 선정합니다.

그 후 게임 종료 UI Panel을 활성화합니다.
중간에 게임에서 나간 플레이어는 결과창에 표시되지 않고
승리팀에서 가장 MVP 지표가 좋은 플레이어에게 MVP를 표시합니다.
이제 MVP의 경우 재화 150개, 승리팀에게는 재화 100개, 패배팀에게는 재화 50개를 지급합니다.

게임 종료 Panel에서 확인 버튼을 누른다면 다시 해당 룸으로 돌아오게 됩니다.
여기까지가 게임 실행 가이드 였습니다.

 
## 코드 컨벤션

### 깃 커밋 규칙
| 타입 | 내용 |
| --------- | --------------------- |
|[Feat] | 새로운 기능을 커밋할 때 사용 |
|[Fix]  | 기존의 버그를 수정할 때 사용 |
|[Refactor] | 코드 리팩토링을 할 때 사용 |
|[Docs] | 문서 부분을 수정할 때 사용 |
|[Build] | 빌드 파일 관련 부분 수정에 사용 |
|[Chore]| 자잘한 수정 사항을 커밋할 때 사용|
|[test] | 테스트 코드(Debug)와 관련된 부분 수정에 사용 |

### 깃허브 업로드 (브랜치)
- 마스터
  - 정식 버전용 마스터 브랜치
- develop
  - 기능 개발용 브랜치
  - 매 작업일 아침과 저녁에 각 작업물들을 해당 브랜치로 머지를 진행할 예정입니다.
  - 각 팀원분들은 develop에서 각자의 브랜치를 새로 개설하여 작업을 진행합니다.
- 개인 작업용 브랜치
  - 개인 작업용 브랜치는 각자 작업을 진행할 때 충돌 방지를 위하여 진행합니다.
  - 머지 과정을 마친 develop에서 각자 브랜치를 파서 진행하게 됩니다.
  - 브랜치 명
    - (개인 이름 이니셜)/(개발 내용)으로 진행하도록 하겠습니다.
    - EX) CSJ/Feat-Battle
  - 가독성을 위하여 병합을 마친 이후 각 브랜치는 삭제를 진행할 예정입니다.

### 폴더 구조
1. 개인 폴더
  - 개인별 폴더를 사용하여 우선 해당 폴더내에서 작업을 진행합니다
  - EX) Assets/Workspace/CSJ/CSJ_Scripts
  - 해당 개인 폴더내의 씬들은 만든 본인 이외에 건들지 않으며 필요시 해당 씬을 자신의 폴더로 복사하여 사본으로 수정을 진행합니다.
2. Imports
  - 우리 팀의 작업물 이외의 외부 작업물들을 보관하는 폴더입니다.
  - gitignore를 적용하여 github에 업로드가 진행되지 않도록 합니다.
3. Resource (서브모듈 폴더)
  - Assets 외부에 존재하는 폴더로 private key나 에셋등을 해당 폴더에 업로드할 예정입니다.
  - 해당 폴더또한 github에서 git pull을 별개로 받아야합니다.
  - 해당 폴더에서 에셋을 복사하여 imports에 적용시켜주시면 됩니다.
